/* wslpress 全局样式 - 匹配 GitHub 原生 UI（修复夜间模式标题颜色） */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========== 1. 核心变量定义（浅色/深色模式） ========== */
:root {
  /* GitHub 浅色模式原生变量 */
  --color-text-primary: #1f2328;
  --color-text-secondary: #656d76;
  --color-text-link: #0969da;
  --color-text-link-hover: #0655ba;
  --color-bg-primary: #ffffff;
  --color-bg-secondary: #f6f8fa;
  --color-bg-tertiary: #f0f2f5;
  --color-border-primary: #d0d7de;
  --color-border-secondary: #e9eef2;
  --font-family-primary: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
  --font-family-mono: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --border-radius-md: 6px;
  --transition-default: 0.2s ease-in-out;
  --color-table-header-bg: #f3f4f6;
  --color-table-row-bg: #ffffff;
  --color-table-row-hover-bg: #f9fafb;
}

/* 关键：绑定 html.dark 确保夜间模式变量生效（覆盖框架默认样式） */
html.dark {
  /* GitHub 深色模式原生变量 */
  --color-text-primary: #e6edf3;
  --color-text-secondary: #8b949e;
  --color-text-link: #58a6ff;
  --color-text-link-hover: #3b82f6;
  --color-bg-primary: #0d1117;
  --color-bg-secondary: #161b22;
  --color-bg-tertiary: #21262d;
  --color-border-primary: #30363d;
  --color-border-secondary: #21262d;
  --color-table-header-bg: #1f2937;
  --color-table-row-bg: #111827;
  --color-table-row-hover-bg: #1a202c;
}

/* ========== 2. 基础样式（Next.js + Tailwind 规范） ========== */
@layer base {
  * {
    @apply m-0 p-0 box-border;
    -webkit-tap-highlight-color: transparent;
  }

  html {
    @apply scroll-smooth;
    -webkit-overflow-scrolling: touch;
  }

  body {
    @apply font-sans text-[--color-text-primary] bg-[--color-bg-primary] min-h-screen overflow-x-hidden;
    font-family: var(--font-family-primary);
  }

  /* 基础排版（强制继承变量，修复标题黑色问题） */
  h1, h2, h3, h4, h5, h6 {
    @apply font-semibold text-[--color-text-primary] !important; /* 提升优先级 */
    word-wrap: break-word;
  }
  h1 { @apply text-2xl mt-10 mb-2; }
  h2 { @apply text-xl mt-8 mb-2 pb-1 border-b border-[--color-border-primary] w-full; }
  h3 { @apply text-lg mt-6 mb-2; }
  h4 { @apply text-base; }
  h5 { @apply text-sm; }
  h6 { @apply text-xs text-[--color-text-secondary] !important; }

  p {
    @apply mb-4 leading-relaxed text-[--color-text-primary] !important;
    word-wrap: break-word;
  }

  /* 链接样式（保留原有微调 + 适配深色模式） */
  a {
    @apply text-[--color-text-link] no-underline transition-colors duration-[--transition-default] inline-block;
  }
  a:hover {
    @apply text-[--color-text-link-hover] underline;
  }

  /* 原有 prose 链接样式保留 */
  .prose a {
    text-decoration: underline;
    text-underline-offset: 3px;
    @apply text-[--color-text-link] !important;
  }

  /* 代码样式（GitHub 原生） */
  code, pre {
    @apply font-mono text-sm;
    font-smooth: never;
    -webkit-font-smoothing: none;
  }
  code {
    @apply px-1 py-0.5 bg-[--color-bg-secondary] rounded-sm text-[--color-text-primary] !important;
    word-break: break-word;
  }
  pre {
    @apply p-4 bg-[--color-bg-secondary] rounded-md overflow-auto mb-4 border border-[--color-border-secondary] text-[--color-text-primary] !important;
  }
  pre code {
    @apply p-0 bg-transparent rounded-none;
  }

  /* 列表/引用/表格 */
  ul, ol {
    @apply mb-4 pl-6 list-outside;
  }
  li {
    @apply mb-1 text-[--color-text-primary] !important;
  }

  blockquote {
    @apply m-0 mb-4 pl-4 border-l-4 border-[--color-border-primary] text-[--color-text-secondary] !important;
  }

  table {
    @apply w-full mb-4 border-collapse overflow-auto block;
  }
  th, td {
    @apply p-2 px-3 border border-[--color-border-primary] text-[--color-text-primary] !important;
  }
  th {
    @apply font-semibold bg-[--color-bg-secondary] text-left;
  }
}

/* ========== 3. 组件样式（博客核心 + GitHub 原生） ========== */
@layer components {
  /* 原有玻璃背景样式（适配深色模式） */
  .bg-frost {
    background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
    backdrop-filter: blur(6px);
    @apply dark:bg-gradient-to-b dark:from-[rgba(255,255,255,0.03)] dark:to-[rgba(255,255,255,0.01)];
  }

  /* 按钮组件 */
  .btn {
    @apply inline-block px-4 py-1.5 text-sm font-medium rounded-[--border-radius-md] border border-[--color-border-primary] bg-[--color-bg-secondary] text-[--color-text-primary] cursor-pointer transition-all duration-[--transition-default] outline-none;
  }
  .btn:hover {
    @apply bg-[--color-bg-tertiary] no-underline;
  }
  .btn-primary {
    @apply bg-[--color-text-link] text-white border-[--color-border-primary] !important;
  }
  .btn-primary:hover {
    @apply bg-[--color-text-link-hover] text-white !important;
  }

  /* 文章卡片（核心修复：标题颜色强制绑定变量） */
  .article-card {
    @apply bg-[--color-bg-primary] border border-[--color-border-primary] rounded-md shadow-sm p-4 mb-4 transition-shadow hover:shadow-md hover:-translate-y-1;
  }
  .article-card-title {
    @apply text-lg font-semibold mb-2 text-[--color-text-link] !important; /* 强制生效，修复夜间黑色 */
    text-decoration: none;
  }
  .article-card-title:hover {
    @apply text-[--color-text-link-hover] underline !important;
  }
  .article-card-meta {
    @apply text-xs text-[--color-text-secondary] mb-2 flex gap-3 !important;
  }
  .article-card-excerpt {
    @apply text-[--color-text-primary] leading-relaxed mb-2 line-clamp-3 !important;
  }
  .article-card-tag {
    @apply inline-block px-2 py-0.5 text-xs text-[--color-text-secondary] bg-[--color-bg-secondary] rounded-full mr-1 !important;
  }

  /* 导航栏 */
  .navbar {
    @apply w-full bg-[--color-bg-primary] border-b border-[--color-border-primary] py-2 px-4 sticky top-0 z-10 flex items-center justify-between flex-wrap;
  }
  .navbar-logo {
    @apply flex items-center gap-2 text-[--color-text-primary] font-semibold text-lg !important;
  }
  .navbar-logo:hover {
    @apply text-[--color-text-link] no-underline !important;
  }
  .navbar-menu {
    @apply flex gap-3 flex-wrap;
  }
  .navbar-item {
    @apply text-[--color-text-primary] text-sm font-medium py-1 px-2 rounded-sm leading-5 hover:bg-[--color-bg-tertiary] hover:text-[--color-text-link] !important;
  }
  .navbar-item.active {
    @apply text-[--color-text-link] font-semibold !important;
  }

  /* 评论区 */
  .comment-container {
    @apply mt-10 border-t border-[--color-border-primary] pt-4;
  }
  .comment-header {
    @apply text-lg font-semibold mb-4 text-[--color-text-primary] !important;
  }
  .comment-item {
    @apply flex gap-4 mb-6 flex-wrap;
  }
  .comment-avatar {
    @apply w-10 h-10 rounded-full bg-[--color-bg-secondary] object-cover flex-shrink-0;
  }
  .comment-content {
    @apply flex-1 min-w-[280px];
  }
  .comment-author {
    @apply font-semibold text-[--color-text-primary] mb-1 flex items-center gap-1 !important;
  }
  .comment-time {
    @apply text-xs text-[--color-text-secondary] font-normal !important;
  }
  .comment-body {
    @apply text-[--color-text-primary] leading-relaxed mb-2 !important;
  }
  .comment-actions {
    @apply flex gap-3 text-xs;
  }
  .comment-action {
    @apply text-[--color-text-secondary] hover:text-[--color-text-link] no-underline !important;
  }

  /* 页脚 */
  .footer {
    @apply w-full border-t border-[--color-border-primary] py-4 px-4 mt-10 bg-[--color-bg-primary];
  }
  .footer-content {
    @apply max-w-[1280px] mx-auto flex justify-between flex-wrap gap-4 w-full;
  }
  .footer-links {
    @apply flex gap-3 text-xs;
  }
  .footer-copyright {
    @apply text-xs text-[--color-text-secondary] !important;
  }

  /* 通用容器 */
  .container {
    @apply max-w-[1280px] mx-auto px-4 w-full;
  }
}

/* ========== 4. 工具类补充 ========== */
@layer utilities {
  .scrollbar-thin {
    scrollbar-width: thin;
  }
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

/* ========== 5. 响应式适配 ========== */
@media (max-width: 768px) {
  .d-sm-none { @apply hidden !important; }
  .d-sm-block { @apply block !important; }

  body { @apply px-2; }
  .article-card { @apply p-3; }
  pre { @apply p-3; }

  /* 导航栏移动端 */
  .navbar {
    @apply px-2 gap-2;
  }
  .navbar-menu {
    @apply w-full mt-2 gap-1;
  }

  /* 评论区移动端 */
  .comment-item {
    @apply flex-col gap-2;
  }
  .comment-avatar {
    @apply w-8 h-8;
  }
  .comment-content {
    @apply min-w-full;
  }

  /* 页脚移动端 */
  .footer-content {
    @apply flex-col gap-2;
  }
  .footer-links {
    @apply flex-wrap;
  }
}

/* 4K大屏适配 */
@media (min-width: 1920px) {
  .container {
    @apply max-w-[1600px];
  }
  :root {
    font-size: 18px;
  }
}

  /* Table styles */
  .prose table {
    @apply w-full border-collapse my-6;
    border-color: var(--color-border);
    transition: border-color 0.3s ease;
    display: block;
    width: 100%;
    overflow-x: auto;
    white-space: nowrap;
  }

  .prose th,
  .prose td {
    @apply p-3 text-left align-top border;
    border-color: var(--color-border);
    color: var(--color-text-primary);
    transition:
      background-color 0.3s ease,
      border-color 0.3s ease;
  }

  .prose th {
    @apply font-semibold;
    background-color: var(--color-table-header-bg);
  }

  .prose tr {
    background-color: var(--color-table-row-bg);
    transition: background-color 0.3s ease;
  }

  .prose tr:nth-child(even) {
    background-color: var(--color-table-row-hover-bg);
  }

  .prose tr:hover {
    background-color: var(--color-table-row-hover-bg);
  }
